---
import Layout from '../layouts/Layout.astro';
import { getDriversBySeason } from '../lib/api';

let drivers = [];
let error = null;

try {
  const driversData = await getDriversBySeason(2024);
  drivers = driversData.drivers || [];
} catch (e) {
  error = e instanceof Error ? e.message : 'Unknown error';
  console.error('Error fetching drivers:', e);
}
---

<Layout title="Drivers Test">
  <div class="max-w-7xl mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold text-white mb-8">Drivers Test Page</h1>

    {error ? (
      <div class="bg-red-900/50 border border-red-700 rounded-lg p-6">
        <h2 class="text-xl font-bold text-red-400 mb-2">Error</h2>
        <p class="text-red-300">{error}</p>
      </div>
    ) : (
      <div>
        <p class="text-gray-400 mb-4">Found {drivers.length} drivers</p>
        <div class="space-y-4">
          {drivers.slice(0, 5).map((driver: any) => (
            <div class="bg-gray-900 border border-gray-800 rounded-lg p-4">
              <h3 class="text-white font-bold">{driver.driverName}</h3>
              <p class="text-gray-400">{driver.teamName} - {driver.stats.totalPoints} points</p>
            </div>
          ))}
        </div>
      </div>
    )}
  </div>
</Layout>
